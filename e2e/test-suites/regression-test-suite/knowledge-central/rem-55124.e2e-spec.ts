import { StepLogger } from '../../../../core/logger/step-logger';
import { PageHelper } from '../../../components/html/page-helper';
import { KnowledgeCentralContentManagerPageHelper } from '../../../page-objects/pages/knowledge-central-content-manager/knowledge-central-content-manager.helper';
import { KnowledgeCentralLoginPageHelper } from '../../../page-objects/pages/knowledge-central-login-page/knowledge-central-login.helper';
import { AgentMicrositeSelfServiceConstant } from '../../../page-objects/pages/self-service/agent-microsite-tab/agent-microsite.constant';
import { AgentMicrositeSelfServiceHelper } from '../../../page-objects/pages/self-service/agent-microsite-tab/agent-microsite.helper';
import { SuiteNames } from '../../helpers/suite-names';

describe(SuiteNames.regressionSuite, () => {
    let loginPageHelper: KnowledgeCentralLoginPageHelper;

    beforeAll(async () => {
        loginPageHelper = KnowledgeCentralLoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
        StepLogger.preCondition('Login and search for random document');
        await loginPageHelper.goTo();
        await KnowledgeCentralLoginPageHelper.loginAsAdmin();
        await KnowledgeCentralContentManagerPageHelper.searchRandomDoc();
    });

    // Jira References - KNOV-493
    it('Verify the highlight option in a document - [23205353]', async () => {
        // Auto generated by aurea-automation - util on Tue, 02 Jul 2019 10:19:57 GMT

        StepLogger.caseId = 23205353;
        StepLogger.stepId(1);
        StepLogger.step('Verify if user is able to view the document searched');
        // Handled in verification
        StepLogger.verification('User should be able to view the document searched without any errors');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();

        StepLogger.stepId(2);
        StepLogger.step('Check if user is able to view different toolbar functions that user is able to perform on a document');
        // Handled in verification
        StepLogger.verification('User should be able to view view different toolbar functions that user is able to perform on a document');
        await KnowledgeCentralContentManagerPageHelper.verifyDocOptions();

        StepLogger.stepId(3);
        StepLogger.step('Check if user is able to view a highlight option');
        // Handled in verification
        StepLogger.verification('User should be able to view a highlight option');
        await KnowledgeCentralContentManagerPageHelper.verifyHighlightOption();

        StepLogger.stepId(4);
        StepLogger.step('Click on the highlight option');
        await KnowledgeCentralContentManagerPageHelper.clickOnHighlight();
        StepLogger.verification(`User should be able to turn the highlight option ON
         (it would turn dark blue indicating it is on) and the search keyword in TCC22955172 should be highlighted in the document`);
        await KnowledgeCentralContentManagerPageHelper.verifyHighlightOn();
        await KnowledgeCentralContentManagerPageHelper.verifyStringHighlighted();

        StepLogger.stepId(5);
        StepLogger.step('Click on the highlight option again to turn it off');
        await KnowledgeCentralContentManagerPageHelper.clickOffHighlight();
        StepLogger.verification('User should be able to turn off the highlight option and the search words are no longer highlighted in the document');
        await KnowledgeCentralContentManagerPageHelper.verifyHighlightOption();
        await KnowledgeCentralContentManagerPageHelper.verifyStringNotHighlighted();
    });

    // Jira References - KNOV-493
    it('Verify the full screen option in a document - [23205354]', async () => {
        // Auto generated by aurea-automation - util on Thu, 04 Jul 2019 07:26:03 GMT

        StepLogger.caseId = 23205354;
        StepLogger.stepId(1);
        StepLogger.step('Verify if user is able to view the document searched');
        // Handled in verification
        StepLogger.verification('User should be able to view the document searched without any errors');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();

        StepLogger.stepId(2);
        StepLogger.step('Check if user is able to view a full screen option');
        // Handled in verification
        StepLogger.verification('User should be able to view full screen option');
        await KnowledgeCentralContentManagerPageHelper.verifyFullScreenOption();

        StepLogger.stepId(3);
        StepLogger.step('Click on the full screen option');
        // Handled in verification
        StepLogger.verification('User should be able to view the document in full screen mode');
        await KnowledgeCentralContentManagerPageHelper.clickFullScreenAndVerifyOpen();

        StepLogger.stepId(4);
        StepLogger.step('Click on close (x) button in full screen mode');
        await AgentMicrositeSelfServiceHelper.closeNewPage();
        StepLogger.verification('User should be able to close the full screen preview and return back to the original view of the document');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();
    });

    // Jira References - KNOV-493
    it('Verify Add to Favorites - Always Use Title option in a document - [23205364]', async () => {
        // Auto generated by aurea-automation - util on Thu, 04 Jul 2019 07:58:06 GMT

        StepLogger.caseId = 23205364;
        StepLogger.stepId(1);
        StepLogger.step('Check if user is able to view a "Add to favorites" option');
        // Handled in verification
        StepLogger.verification('User should be able to view "Add to Favorites" option');
        await KnowledgeCentralContentManagerPageHelper.verifyAddToFavoritesDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Click on the "Add to Favorites" option');
        await KnowledgeCentralContentManagerPageHelper.clickAddToFavorites();
        StepLogger.verification(`User should be able to view "Add to Favorites" dialog box with the below options
				Always Use Title
		Specify Favorite Label`);
        await AgentMicrositeSelfServiceHelper.verifyDialogPageTitle(AgentMicrositeSelfServiceConstant.titles.addToFavorites);
        await KnowledgeCentralContentManagerPageHelper.verifyFavoriteOptionsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Verify the option chosen by default');
        // Handled in verification
        StepLogger.verification('Always Use Title should be chosen by default and the title box will be grayed out without an option to edit');
        await KnowledgeCentralContentManagerPageHelper.verifyAlwaysUseDocumentTitleRadioButtonChecked();

        StepLogger.stepId(4);
        StepLogger.step('Click on Submit');
        await AgentMicrositeSelfServiceHelper.clickOnSubmit();
        StepLogger.verification('User should be able to view a message as "Document has been added to favorites"');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentAddedMessageDisplayed();

        StepLogger.stepId(5);
        StepLogger.step('Click on "Close Window" in the "Add to Favorites" dialog box');
        await AgentMicrositeSelfServiceHelper.closeNewPage();
        StepLogger.verification('The dialog box should be closed and user will be returned to the original document view');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();
    });

    // Jira References - KNOV-493
    it('Verify Subscribe to document via email option - [23205424]', async () => {
        // Auto generated by aurea-automation - util on Thu, 04 Jul 2019 09:58:40 GMT

        StepLogger.caseId = 23205424;
        StepLogger.stepId(1);
        StepLogger.step('Check if user is able to view a "Subscribe to Document through Email" option');
        // Handled in verification
        StepLogger.verification('User should be able to view a "Subscribe to Document through Email" option');
        await KnowledgeCentralContentManagerPageHelper.verifySubscribeToDocumentDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Click on "Subscribe to Document through Email"');
        await KnowledgeCentralContentManagerPageHelper.clickSubscribeToDocument();
        StepLogger.verification('User is able to view "Email Subscription Details" window');
        await KnowledgeCentralContentManagerPageHelper.verifyEmailSubscriptionWindow();

        StepLogger.stepId(3);
        StepLogger.step('Verify the details in the Email Subscription Details window');
        // Handled in verification
        StepLogger.verification('User should be able to view the following details Titlesynopsis Send Emails (drop down)');
        await KnowledgeCentralContentManagerPageHelper.verifySubscribeToDocumentPageItems();

        StepLogger.stepId(4);
        StepLogger.step('Click on the drop down for "Send Emails"');
        // Handled in verification
        StepLogger.verification('User should be able to view the options - Immediately , Daily , Weekly');
        await KnowledgeCentralContentManagerPageHelper.verifySendMailOptionsDisplayed();

        StepLogger.stepId(5);
        StepLogger.step('Choose an option from the dropdown to send emails eg: Immediately');
        // Handled in verification
        StepLogger.verification('User should be able to choose the option "Immediately"');
        await AgentMicrositeSelfServiceHelper.selectAndVerifyAnyValueForSendEmails(AgentMicrositeSelfServiceConstant.testData.immediately);

        StepLogger.stepId(6);
        StepLogger.step('Click on "Submit"');
        await KnowledgeCentralContentManagerPageHelper.clickOnSubmit();
        StepLogger.verification('User should be redirected back to the original document');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();
    });

    // Jira References - KNOV-493
    it('Verify "Subscribe to document through RSS" option - [23205714]', async () => {
        // Auto generated by aurea-automation - util on Thu, 04 Jul 2019 11:26:04 GMT

        StepLogger.caseId = 23205714;
        StepLogger.stepId(1);
        StepLogger.step('Check if user is able to view a "Subscribe to document through RSS" option');
        // Handled in verification
        StepLogger.verification('User should be able to view a "Subscribe to document through RSS" option');
        await KnowledgeCentralContentManagerPageHelper.verifySubscribeByRSSOption();

        StepLogger.stepId(2);
        StepLogger.step('Click on "Subscribe to document through RSS"');
        await KnowledgeCentralContentManagerPageHelper.clickOnSubscribeByRSS();
        StepLogger.verification('User should be able to view a "RSS Subscription Details" window');
        await AgentMicrositeSelfServiceHelper.verifyRSSSubscriptionWindow();

        StepLogger.stepId(3);
        StepLogger.step('Verify the details in the "RSS Subscription Details" window');
        // Handled in verification
        StepLogger.verification(`User should be able to view instructions to add tot he RSS reader and also the title ,
         synopsis and URL to copy to the reader`);
        await KnowledgeCentralContentManagerPageHelper.verifySubscribeToDocumentRssItems();

        StepLogger.stepId(4);
        StepLogger.step('Click on Close button in the "RSS Subscription Details" window');
        await AgentMicrositeSelfServiceHelper.closeNewPage();
        StepLogger.verification('User should be able to view the original document');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();
    });

    // Jira References - KNOV-493
    it('Verify "Print Document" option - [23205816]', async () => {
        // Auto generated by aurea-automation - util on Fri, 05 Jul 2019 07:26:08 GMT

        StepLogger.caseId = 23205816;
        StepLogger.stepId(1);
        StepLogger.step('Check if user is able to view a "Print Document" option');
        // Handled in verification
        StepLogger.verification('User should be able to view a "Print Document" option');
        await KnowledgeCentralContentManagerPageHelper.verifyPrintOptionDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Click on "Print Document"');
        // Handled in verification
        StepLogger.verification('User should be able to view the print preview version of the document in full screen mode');
        await KnowledgeCentralContentManagerPageHelper.clickOnPrintAndVerifyOpen();

        StepLogger.stepId(3);
        StepLogger.step('Click on Close (X) to close the full screen print preview window');
        await AgentMicrositeSelfServiceHelper.closeNewPage();
        StepLogger.verification('User should be able to close the print preview view and returned to the original document view');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();
    });

    // Jira References - KNOV-493
    it('Verify "Manage Document" option - [23205868]', async () => {
        // Auto generated by aurea-automation - util on Fri, 05 Jul 2019 07:54:27 GMT

        StepLogger.caseId = 23205868;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is able to view the document');
        // Handled in verification
        StepLogger.verification('User should be able to view the document');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();

        StepLogger.stepId(2);
        StepLogger.step('Check if user is able to view a "Manage Document" option');
        // Handled in verification
        StepLogger.verification('User should be able to view a "Manage Document" option');
        await KnowledgeCentralContentManagerPageHelper.verifyManageOptionDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on "Manage Document" option');
        // Handled in verification
        StepLogger.verification('User should be able to view the "Manage Document" window');
        await KnowledgeCentralContentManagerPageHelper.clickOnManageAndVerifyOpen();
    });

    // Jira References - KNOV-493
    it('Verify "Copy Document URL to Clipboard" option - [23205877]', async () => {
        // Auto generated by aurea-automation - util on Fri, 05 Jul 2019 08:10:19 GMT

        StepLogger.caseId = 23205877;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is able to view the document');
        // Handled in verification
        StepLogger.verification('User should be able to view the document');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();

        StepLogger.stepId(2);
        StepLogger.step('Check if user is able to view a "Copy Document URL to Clipboard" option');
        // Handled in verification
        StepLogger.verification('User should be able to view a "Copy Document URL to Clipboard" option');
        await KnowledgeCentralContentManagerPageHelper.verifyClipboardOptionDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on "Copy Document URL to Clipboard" option');
        // Handled in verification
        StepLogger.verification('The Document URL should be copied to clipboard PS - Cant attach this snapshot of URL being copied to clipboard');
        await KnowledgeCentralContentManagerPageHelper.clickOnClipboardAndVerifyOpen();

        // Step Skipped since its out of browser navigation and will not affect test case execution
        StepLogger.stepId(4);
        StepLogger.step('Open a notepad and paste the URL there to verify if copied to clipboard worked fine');
        StepLogger.verification('User should be able to paste the URL in the notepad');

        StepLogger.stepId(5);
        StepLogger.step('Open a new tab in the browser and paste the copied URL to verify if it redirects to the same document');
        await KnowledgeCentralContentManagerPageHelper.pasteClipBoardInNewTab();
        StepLogger.verification('User should be able to view the same document in step 1');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitleInNewTab();
    });

    // Jira References - KNOV-493
    it('Verify "Up To Search results" option - [23205900]', async () => {
        // Auto generated by aurea-automation - util on Fri, 05 Jul 2019 09:06:44 GMT

        StepLogger.caseId = 23205900;
        StepLogger.stepId(1);
        StepLogger.step('Verify user is able to view the document');
        // Handled in verification
        StepLogger.verification('User should be able to view the document');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();

        StepLogger.stepId(2);
        StepLogger.step('Check if user is able to view a "Up to search results" option');
        // Handled in verification
        StepLogger.verification('User should be able to view a "Up to search results" option');
        await KnowledgeCentralContentManagerPageHelper.verifyUpToSearchResults();

        StepLogger.stepId(3);
        StepLogger.step('Click on "Up to search results" option');
        await KnowledgeCentralContentManagerPageHelper.clickUpToSearchResults();
        StepLogger.verification('User should be navigated to the search results page');
        await KnowledgeCentralContentManagerPageHelper.verifyUserNavigateBack();
    });

    // Jira References - KNOV-493
    it('Verify "Add to Favorites - Specify Favorite Label" option in a document - [23205970]', async () => {
        // Auto generated by aurea-automation - util on Fri, 05 Jul 2019 09:24:34 GMT

        StepLogger.caseId = 23205970;
        StepLogger.stepId(1);
        StepLogger.step('Click on the "Add to Favorites" option');
        await KnowledgeCentralContentManagerPageHelper.searchRandomDoc();
        await KnowledgeCentralContentManagerPageHelper.clickAddToFavorites();
        StepLogger.verification(`User should be able to view "Add to Favorites" dialog box with the below options
				Always Use Title
		Specify Favorite Label`);
        await AgentMicrositeSelfServiceHelper.verifyDialogPageTitle(AgentMicrositeSelfServiceConstant.titles.addToFavorites);
        await KnowledgeCentralContentManagerPageHelper.verifyFavoriteOptionsDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Choose "Specify Favorite Label" radio button');
        await KnowledgeCentralContentManagerPageHelper.specifyFavoriteLabel();
        StepLogger.verification('The label field should turn editable');
        await KnowledgeCentralContentManagerPageHelper.verifySpecifyEnabled();

        StepLogger.stepId(3);
        StepLogger.step('Enter a label eg: Test Doc Favorite Label');
        const label = await KnowledgeCentralContentManagerPageHelper.enterSpecificLabel(PageHelper.getUniqueId());
        StepLogger.verification('User should be able to enter the text in the text field');
        await KnowledgeCentralContentManagerPageHelper.verifySpecificLabel(label);

        StepLogger.stepId(4);
        StepLogger.step('Click on Submit');
        await AgentMicrositeSelfServiceHelper.clickOnSubmit();
        StepLogger.verification('User should be able to view a message as "Document has been added to favorites"');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentAddedMessageDisplayed();

        StepLogger.stepId(5);
        StepLogger.step('Click on "Close Window" in the "Add to Favorites" dialog box');
        await AgentMicrositeSelfServiceHelper.closeNewPage();
        StepLogger.verification('The dialog box should be closed and user will be returned to the original document view');
        await KnowledgeCentralContentManagerPageHelper.verifyDocumentTitle();
    });
});
