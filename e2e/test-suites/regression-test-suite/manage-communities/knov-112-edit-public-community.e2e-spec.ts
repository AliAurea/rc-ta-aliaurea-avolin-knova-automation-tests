import { StepLogger } from '../../../../core/logger/step-logger';
import { PageHelper } from '../../../components/html/page-helper';
import { AdminLoginPageHelper } from '../../../page-objects/pages/admin-login-page/admin-login.helper';
import { CommunitiesManagerConstant } from '../../../page-objects/pages/manage-communities/communities-manager/communities-manager.constants';
import { CommunitiesManagerHelper } from '../../../page-objects/pages/manage-communities/communities-manager/communities-manager.helper';
import { SuiteNames } from '../../helpers/suite-names';

describe(SuiteNames.regressionSuite, () => {
    let loginPageHelper: AdminLoginPageHelper;
    let communityName = `${CommunitiesManagerConstant.labels.test}`;
    let categoryName = `${CommunitiesManagerConstant.labels.test}`;

    beforeAll(async () => {
        loginPageHelper = AdminLoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
    });

    beforeEach(async () => {
        await PageHelper.switchToFirstTab();
        await loginPageHelper.goTo();
        await AdminLoginPageHelper.logout();
        await AdminLoginPageHelper.loginAsAdmin();
    });

    // Jira References - KNOV-1347
    it('Create a Community Category with blank field - [22250118]', async () => {
        // Auto generated by aurea-automation - util on Tue, 05 Mar 2019 08:13:49 GMT
        StepLogger.caseId = 22250118;

        StepLogger.preCondition('Navigate to Communities Manager');
        await CommunitiesManagerHelper.navigateToCommunitiesManager(true);

        StepLogger.stepId(1);
        StepLogger.step('Click on the "Create Subcategory" at the button of the page');
        await CommunitiesManagerHelper.clickCreateSubcategory();
        StepLogger.verification('The Category creation modal pop up page is displayed');
        await CommunitiesManagerHelper.verifyCreateSubcategoryDialog(true);

        StepLogger.stepId(2);
        StepLogger.step('Click the "Submit" button');
        await CommunitiesManagerHelper.clickSubcategorySubmitButton();
        StepLogger.verification('A pop up alert is displayed with a message "Please enter the sub category name"');
        await CommunitiesManagerHelper.verifySubcategoryNameWindow();

        StepLogger.stepId(3);
        StepLogger.step('Click on the "OK" button');
        await CommunitiesManagerHelper.clickOkButton();
        StepLogger.verification('The Pop up alert page is closed and the Category Creation modal is displayed');
        await CommunitiesManagerHelper.verifyWindowClosed();
    });

    // Jira References - KNOV-1348
    it('Edit the Properties of a Public Community - [22250176]', async () => {
        // Auto generated by aurea-automation - util on Tue, 05 Mar 2019 14:47:01 GMT
        StepLogger.caseId = 22250176;
        const editName = `${communityName}${PageHelper.getUniqueId()}`;

        StepLogger.preCondition('Create community subcategory');
        await CommunitiesManagerHelper.createCommunity(communityName);

        StepLogger.stepId(1);
        StepLogger.step('Click on the name of the Public Community record');
        await CommunitiesManagerHelper.clickCommunity(communityName);
        StepLogger.verification(`The Public Community record is highlighted and the following button is visible at the bottom of the page
            "Edit Properties"
            "Edit Visibility"
            "Edit Home Page Options"
            "Delete"`);
        await CommunitiesManagerHelper.verifyCommunityAndButtons(communityName);

        StepLogger.stepId(2);
        StepLogger.step('Click on "Edit Properties" button');
        await CommunitiesManagerHelper.clickEditPropertiesButton();
        StepLogger.verification('The Community Modal is opened with the details of the Public Community');
        await CommunitiesManagerHelper.verifyEditCommunityDialog(true);

        StepLogger.stepId(3);
        StepLogger.step('Edit the name value of the Public Community in the "Name" textbox');
        await CommunitiesManagerHelper.enterCommunityName(editName);
        StepLogger.verification('The Name value is changed in the "Name" textbox');
        await CommunitiesManagerHelper.verifyCommunityName(editName);

        StepLogger.stepId(4);
        StepLogger.step('Edit the Description text area');
        await CommunitiesManagerHelper.enterCommunityDescription(editName);
        StepLogger.verification('The Description value is changed');
        await CommunitiesManagerHelper.verifyCommunityDescription(editName);

        StepLogger.stepId(5);
        StepLogger.step('Click the "Submit" button');
        await CommunitiesManagerHelper.clickCommunitySubmitButton();
        StepLogger.verification('The Community modal pop up page is closed and the changes is saved successfully');
        await CommunitiesManagerHelper.verifyEditedCommunity(editName);

        StepLogger.postCondition('Delete community');
        await CommunitiesManagerHelper.deleteCommunity(editName, false);
    });

    // Jira References - KNOV-1349
    it('Edit a the Visibility of a Community - [22250185]', async () => {
        // Auto generated by aurea-automation - util on Tue, 05 Mar 2019 14:47:01 GMT
        StepLogger.caseId = 22250185;
        communityName = `${communityName}${PageHelper.getUniqueId()}`;

        StepLogger.preCondition('Create community subcategory');
        await CommunitiesManagerHelper.createCommunity(communityName);

        StepLogger.stepId(1);
        StepLogger.step('Click on the name of the Public Community record');
        await CommunitiesManagerHelper.clickCommunity(communityName);
        StepLogger.verification(`The Public Community record is highlighted and the following button is visible at the bottom of the page
            "Edit Properties"
            "Edit Visibility"
            "Edit Home Page Options"
            "Delete"`);
        await CommunitiesManagerHelper.verifyCommunityAndButtons(communityName);

        StepLogger.stepId(2);
        StepLogger.step('Click on "Edit Visibility" button');
        await CommunitiesManagerHelper.clickEditVisibilityButton();
        StepLogger.verification('The Community modal is opened with the details of the Public Community');
        await CommunitiesManagerHelper.verifyEditVisibilityDialog(true);

        StepLogger.stepId(3);
        StepLogger.step('Click the "Visibility" dropdown box');
        await CommunitiesManagerHelper.clickVisibilityDropdown();
        StepLogger.verification('The List of Visibility is displayed in the dropdown list option');
        await CommunitiesManagerHelper.verifyVisibilityDropdown();

        StepLogger.stepId(4);
        StepLogger.step('Click on the desired option e.g. public / private');
        await CommunitiesManagerHelper.selectVisibility(CommunitiesManagerConstant.visibilityDropdown.private);
        StepLogger.verification('The option selected is displayed in the Visibility Drodown box');
        await CommunitiesManagerHelper.verifySelectedVisibility(CommunitiesManagerConstant.visibilityDropdown.private);

        StepLogger.stepId(5);
        StepLogger.step('Click the "Submit" button');
        await CommunitiesManagerHelper.clickVisibilitySubmitButton();
        StepLogger.verification('The modal pop up page is closed and the changes made saved successfully');
        await CommunitiesManagerHelper.verifyCommunityVisibility(CommunitiesManagerConstant.visibilityDropdown.private);

        StepLogger.postCondition('Delete community');
        await CommunitiesManagerHelper.deleteCommunity(communityName, false);
    });

    // Jira References - KNOV-1350
    it('Edit the Home Page of a Community - [22250186]', async () => {
        // Auto generated by aurea-automation - util on Tue, 05 Mar 2019 14:47:01 GMT
        StepLogger.caseId = 22250186;
        communityName = `${communityName}${PageHelper.getUniqueId()}`;

        StepLogger.preCondition('Create community subcategory');
        await CommunitiesManagerHelper.createCommunity(communityName);

        StepLogger.stepId(1);
        StepLogger.step('Click on the name of the Public Community record');
        await CommunitiesManagerHelper.clickCommunity(communityName);
        StepLogger.verification(`The Public Community record is highlighted and the following button is visible at the bottom of the page
            "Edit Properties"
            "Edit Visibility"
            "Edit Home Page Options"
            "Delete"`);
        await CommunitiesManagerHelper.verifyCommunityAndButtons(communityName);

        StepLogger.stepId(2);
        StepLogger.step('Click the "Edit Home Page Options" button');
        await CommunitiesManagerHelper.clickEditHomePageButton();
        StepLogger.verification('A modal pop up page is displayed');
        await CommunitiesManagerHelper.verifyHomePageDialog(true);

        StepLogger.stepId(3);
        StepLogger.step('Click on the radio button of the desired option e.g "This Community category page uses this Template"');
        await CommunitiesManagerHelper.clickPageUsesTemplateButton();
        StepLogger.verification('The radio button is selected');
        await CommunitiesManagerHelper.verifyPageUsesTemplateSelected();

        StepLogger.stepId(4);
        StepLogger.step('Input the file location address in the text box');
        await CommunitiesManagerHelper.selectHomeTemplate(communityName);
        StepLogger.verification('The location address is displayed');
        await CommunitiesManagerHelper.verifyHomeTemplate(communityName);

        StepLogger.stepId(5);
        StepLogger.step('Click the "Submit" button');
        await CommunitiesManagerHelper.clickHomePageSubmitButton();
        StepLogger.verification('The modal pop up is closed and the changes made is saved successfully');
        await CommunitiesManagerHelper.verifyCommunityTemplate(communityName);

        StepLogger.postCondition('Delete community');
        await CommunitiesManagerHelper.deleteCommunity(communityName, false);
    });

    // Jira References - KNOV-1361
    it('Cancel editing the Properties of a Public Community - [22250930]', async () => {
        // Auto generated by aurea-automation - util on Tue, 05 Mar 2019 14:47:01 GMT
        StepLogger.caseId = 22250930;
        communityName = `${communityName}${PageHelper.getUniqueId()}`;
        const editName = `${communityName}${PageHelper.getUniqueId()}`;

        StepLogger.preCondition('Create community subcategory');
        await CommunitiesManagerHelper.createCommunity(communityName);

        StepLogger.stepId(1);
        StepLogger.step('Click on the name of the Public Community record');
        await CommunitiesManagerHelper.clickCommunity(communityName);
        StepLogger.verification(`The Public Community record is highlighted and the following button is visible at the bottom of the page
            "Edit Properties"
            "Edit Visibility"
            "Edit Home Page Options"
            "Delete"`);
        await CommunitiesManagerHelper.verifyCommunityAndButtons(communityName);

        StepLogger.stepId(2);
        StepLogger.step('Click on "Edit Properties" button');
        await CommunitiesManagerHelper.clickEditPropertiesButton();
        StepLogger.verification('The Community Modal is opened with the details of the Public Community');
        await CommunitiesManagerHelper.verifyEditCommunityDialog(true);

        StepLogger.stepId(3);
        StepLogger.step('Edit the name value of the Public Community in the "Name" textbox');
        await CommunitiesManagerHelper.enterCommunityName(editName);
        StepLogger.verification('The Name value is changed in the "Name" textbox');
        await CommunitiesManagerHelper.verifyCommunityName(editName);

        StepLogger.stepId(4);
        StepLogger.step('Edit the Description text area');
        await CommunitiesManagerHelper.enterCommunityDescription(editName);
        StepLogger.verification('The Description value is changed');
        await CommunitiesManagerHelper.verifyCommunityDescription(editName);

        StepLogger.stepId(5);
        StepLogger.step('Click the "Cancel" button');
        await CommunitiesManagerHelper.cancelEditPropertiesButton();
        StepLogger.verification('The Community modal pop up page is closed and the changes made are not saved');
        await CommunitiesManagerHelper.verifyEditedCommunity(communityName);

        StepLogger.postCondition('Delete community');
        await CommunitiesManagerHelper.deleteCommunity(communityName, false);
    });

    // Jira References - KNOV-1351
    it('Delete a Community record - [22250188]', async () => {
        // Auto generated by aurea-automation - util on Tue, 05 Mar 2019 14:47:01 GMT
        StepLogger.caseId = 22250188;
        communityName = `${communityName}${PageHelper.getUniqueId()}`;

        StepLogger.preCondition('Create community subcategory');
        await CommunitiesManagerHelper.createCommunity(communityName);

        StepLogger.stepId(1);
        StepLogger.step('Click on the name of the Public Community record');
        await CommunitiesManagerHelper.clickCommunity(communityName);
        StepLogger.verification(`The Public Community record is highlighted and the following button is visible at the bottom of the page
            "Edit Properties"
            "Edit Visibility"
            "Edit Home Page Options"
            "Delete"`);
        await CommunitiesManagerHelper.verifyCommunityAndButtons(communityName);

        StepLogger.stepId(2);
        StepLogger.step('Click on the "Delete" button');
        await CommunitiesManagerHelper.clickDeleteButton();
        StepLogger.verification('A pop up page is displayed with a message "This community and all it posts will be deleted. Continue?"');
        await CommunitiesManagerHelper.verifyDeleteWindow();

        StepLogger.stepId(3);
        StepLogger.step('Click the "Yes" button');
        await CommunitiesManagerHelper.clickYesDeleteWindow();
        StepLogger.verification('The community is deleted and remove from the list of the community');
        await CommunitiesManagerHelper.verifyCommunityDeleted(communityName);
    });

    // Jira References - KNOV-1352
    it('Cancel deleting a Community record - [22250189]', async () => {
        // Auto generated by aurea-automation - util on Tue, 05 Mar 2019 14:47:01 GMT
        StepLogger.caseId = 22250189;
        communityName = `${communityName}${PageHelper.getUniqueId()}`;

        StepLogger.preCondition('Create community subcategory');
        await CommunitiesManagerHelper.createCommunity(communityName);

        StepLogger.stepId(1);
        StepLogger.step('Click on the name of the Public Community record');
        await CommunitiesManagerHelper.clickCommunity(communityName);
        StepLogger.verification(`The Public Community record is highlighted and the following button is visible at the bottom of the page
            "Edit Properties"
            "Edit Visibility"
            "Edit Home Page Options"
            "Delete"`);
        await CommunitiesManagerHelper.verifyCommunityAndButtons(communityName);

        StepLogger.stepId(2);
        StepLogger.step('Click on the "Delete" button');
        await CommunitiesManagerHelper.clickDeleteButton();
        StepLogger.verification('A pop up page is displayed with a message "This community and all it posts will be deleted. Continue?"');
        await CommunitiesManagerHelper.verifyDeleteWindow();

        StepLogger.stepId(3);
        StepLogger.step('Click the "No" button');
        await CommunitiesManagerHelper.clickNoDeleteWindow();
        StepLogger.verification('The community is not deleted and still exist in the community list');
        await CommunitiesManagerHelper.verifyEditedCommunity(communityName);

        StepLogger.postCondition('Delete community');
        await CommunitiesManagerHelper.deleteCommunity(communityName, false);
    });

    // Jira References - KNOV-1353
    it('Edit a sub category details - [22250196]', async () => {
        // Auto generated by aurea-automation - util on Tue, 05 Mar 2019 14:47:01 GMT
        StepLogger.caseId = 22250196;
        categoryName = `${categoryName}${PageHelper.getUniqueId()}`;
        const editName = `${categoryName}${PageHelper.getUniqueId()}`;

        StepLogger.preCondition('Create community subcategory');
        await CommunitiesManagerHelper.createSubcategory(categoryName);

        StepLogger.stepId(1);
        StepLogger.step('Click on the Sub-Category name');
        await CommunitiesManagerHelper.selectSubcategory(categoryName);
        StepLogger.verification(`The Sub-Category name is highlighted and the following button is displayed at the bottom of the page
            "Create Subcategory"
            "Create Community"
            "Create Private Community"
            "Rename"
            "Delete"`);
        await CommunitiesManagerHelper.verifySubcategorySelected(categoryName);

        StepLogger.stepId(2);
        StepLogger.step('Click the "Rename" button');
        await CommunitiesManagerHelper.clickRenameButton();
        StepLogger.verification('The Subcategory modal pop up is displayed');
        await CommunitiesManagerHelper.verifyCreateSubcategoryDialog(true);

        StepLogger.stepId(3);
        StepLogger.step('Change the value of the "Category" textbox and the "Description" text area');
        await CommunitiesManagerHelper.enterSubcategoryNameAndDescription(editName);
        StepLogger.verification('The Changed are displayed in the Text area');
        await CommunitiesManagerHelper.verifySubcategoryNameAndDescription(editName);

        StepLogger.stepId(4);
        StepLogger.step('Click the "Submit" button');
        await CommunitiesManagerHelper.clickSubcategorySubmitButton();
        StepLogger.verification('The modal pop up is closed and the changes made  are saved successfully');
        await CommunitiesManagerHelper.verifySelectedSubcategory(editName);

        StepLogger.postCondition('Delete category');
        await CommunitiesManagerHelper.deleteCommunity(editName, false);
    });

    // Jira References - KNOV-1354
    it('Delete a sub category - [22250198]', async () => {
        // Auto generated by aurea-automation - util on Wed, 06 Mar 2019 09:38:46 GMT
        StepLogger.caseId = 22250198;
        categoryName = `${categoryName}${PageHelper.getUniqueId()}`;

        StepLogger.preCondition('Create community subcategory');
        await CommunitiesManagerHelper.createSubcategory(categoryName);

        StepLogger.stepId(1);
        StepLogger.step('Click on the Sub-Category name');
        await CommunitiesManagerHelper.selectSubcategory(categoryName);
        StepLogger.verification(`The Sub-Category name is highlighted and the following button is displayed at the bottom of the page
            "Create Subcategory"
            "Create Community"
            "Create Private Community"
            "Rename"
            "Delete"`);
        await CommunitiesManagerHelper.verifySubcategorySelected(categoryName);

        StepLogger.stepId(2);
        StepLogger.step('Click on the "Delete" button');
        await CommunitiesManagerHelper.clickDeleteButton();
        StepLogger.verification('A pop up page is displayed with a message "Delete category [category name]?"');
        await CommunitiesManagerHelper.verifyDeleteCategoryWindow();

        StepLogger.stepId(3);
        StepLogger.step('Click the "Yes" button');
        await CommunitiesManagerHelper.clickYesDeleteWindow();
        StepLogger.verification('The pop up page is closed and the subcategory is removed from the list of community');
        await CommunitiesManagerHelper.verifyCategoryDeleted(categoryName);
    });

    // Jira References - KNOV-1355
    it('Cancel deleting a Sub-Category - [22250199]', async () => {
        // Auto generated by aurea-automation - util on Wed, 06 Mar 2019 09:38:46 GMT
        StepLogger.caseId = 22250199;
        categoryName = `${categoryName}${PageHelper.getUniqueId()}`;

        StepLogger.preCondition('Create community subcategory');
        await CommunitiesManagerHelper.createSubcategory(categoryName);

        StepLogger.stepId(1);
        StepLogger.step('Click on the Sub-Category name');
        await CommunitiesManagerHelper.selectSubcategory(categoryName);
        StepLogger.verification(`The Sub-Category name is highlighted and the following button is displayed at the bottom of the page
            "Create Subcategory"
            "Create Community"
            "Create Private Community"
            "Rename"
            "Delete"`);
        await CommunitiesManagerHelper.verifySubcategorySelected(categoryName);

        StepLogger.stepId(2);
        StepLogger.step('Click on the "Delete" button');
        await CommunitiesManagerHelper.clickDeleteButton();
        StepLogger.verification('A pop up page is displayed with a message "Delete category [category name]?"');
        await CommunitiesManagerHelper.verifyDeleteCategoryWindow();

        StepLogger.stepId(3);
        StepLogger.step('Click the "No" button');
        await CommunitiesManagerHelper.clickNoDeleteWindow();
        StepLogger.verification('The pop up page is closed and the subcategory still exist on the community manager"s page');
        await CommunitiesManagerHelper.verifySelectedSubcategory(categoryName);

        StepLogger.postCondition('Delete community and logout');
        await CommunitiesManagerHelper.deleteCommunity(categoryName, false);
        await AdminLoginPageHelper.logout(true);
    });
});
