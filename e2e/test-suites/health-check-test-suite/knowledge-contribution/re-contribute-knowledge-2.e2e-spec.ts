import { StepLogger } from '../../../../core/logger/step-logger';
import { PageHelper } from '../../../components/html/page-helper';
import { Constants } from '../../../components/misc-utils/constants';
import { AdminLoginPageHelper } from '../../../page-objects/pages/admin-login-page/admin-login.helper';
import { KnowledgeReContributionHelper } from '../../../page-objects/pages/manage-knowledge/knowledge-contribution/knowledge-re-contribution.helper';
import { SuiteNames } from '../../helpers/suite-names';

describe(SuiteNames.healthCheckSuite, () => {
    let loginPageHelper: AdminLoginPageHelper;

    beforeAll(async () => {
        loginPageHelper = AdminLoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
        await loginPageHelper.goTo();
    });

    beforeEach(async () => {
        await PageHelper.switchToFirstTab();
        await loginPageHelper.goTo();
        await AdminLoginPageHelper.logout();
    });

    // Jira References - KNOV-453
    it('To remove the users from Selected Users section. - [22412299]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Feb 2019 08:03:21 GMT
        StepLogger.caseId = 22412299;
        StepLogger.preCondition('Execute test case C22411107 to access Knowledge Re-Contributor screen.');
        await KnowledgeReContributionHelper.navigateToKnowledgeReContribution();

        StepLogger.stepId(1);
        StepLogger.step('Check the "Contribute authored documents" check box.');
        await KnowledgeReContributionHelper.clickContributeAuthoredDocuments();
        StepLogger.verification('The check box should be checked. Generate Bat File and start buttons should get enabled at the bottom of the page.');
        await KnowledgeReContributionHelper.verifyContributeAuthoredDocuments();

        StepLogger.stepId(2);
        StepLogger.step('Provide the id range in the From and To columns.("From" number should always be lower than the "To" number)');
        await KnowledgeReContributionHelper.enterFromAndTwoRange(Constants.stringNumber.one, Constants.stringNumber.two);
        StepLogger.verification('Values should be displayed in the fields.');
        await KnowledgeReContributionHelper.verifyFromAndTwoRange(Constants.stringNumber.one, Constants.stringNumber.two);

        StepLogger.stepId(3);
        StepLogger.step(`-Select the Publication status from the drop down.
            -Select the templates from the list available.
            -Select the style sheets from the list available.`);
        await KnowledgeReContributionHelper.selectPublicationStatusTemplateAndStyle();
        StepLogger.verification('The options should be selected successfully.');
        await KnowledgeReContributionHelper.verifyPublicationStatusTemplateAndStyle();

        StepLogger.stepId(4);
        StepLogger.step('To select the users click on the Select button in front of the user tile.');
        await KnowledgeReContributionHelper.clickSelectUser();
        StepLogger.verification('Select users dialog box should be opened.');
        await KnowledgeReContributionHelper.verifySelectUserDialog();

        StepLogger.stepId(5);
        StepLogger.step('Click on Show All button.');
        await KnowledgeReContributionHelper.clickShowAllUser();
        StepLogger.verification('All the Users should be displayed in the Users section.');
        await KnowledgeReContributionHelper.verifyUserList();

        StepLogger.stepId(6);
        StepLogger.step('Check the checkbox of one or multiple users.');
        await KnowledgeReContributionHelper.selectUser();
        StepLogger.verification('The selected users should be displayed in the Selected users section.');
        await KnowledgeReContributionHelper.verifySelectedUserList();

        StepLogger.stepId(7);
        StepLogger.step('Click on the "minus" icon under the Remove column in the selected users section for the users that need to be removed.');
        await KnowledgeReContributionHelper.clickRemoveUser();
        StepLogger.verification('The users for which remove (minus) icon is clicked, should be removed from the selected users section.');
        await KnowledgeReContributionHelper.verifySelectedUserRemoved();

        StepLogger.postCondition('Logout');
        await KnowledgeReContributionHelper.switchToFirstTabAndLogOut();
    });

    // Jira References - KNOV-453
    it(`To verify the No button in the confirmation pop up window when starting the
        re-contribute Knowledge for Contribute Authored Documents. - [22411113]`, async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Feb 2019 08:03:41 GMT
        StepLogger.caseId = 22411113;
        StepLogger.preCondition('Execute test case C22411107 to access Knowledge Re-Contributor screen.');
        await KnowledgeReContributionHelper.navigateToKnowledgeReContribution();

        StepLogger.stepId(1);
        StepLogger.step('Check the "Contribute authored documents" check box.');
        await KnowledgeReContributionHelper.clickContributeAuthoredDocuments();
        StepLogger.verification('The check box should be checked. Generate Bat File and start buttons should get enabled at the bottom of the page.');
        await KnowledgeReContributionHelper.verifyContributeAuthoredDocuments();

        StepLogger.stepId(2);
        StepLogger.step('Provide the id range in the From and To columns.("From" number should always be lower than the "To" number)');
        await KnowledgeReContributionHelper.enterFromAndTwoRange(Constants.stringNumber.one, Constants.stringNumber.two);
        StepLogger.verification('Values should be displayed in the fields.');
        await KnowledgeReContributionHelper.verifyFromAndTwoRange(Constants.stringNumber.one, Constants.stringNumber.two);

        StepLogger.stepId(3);
        StepLogger.step(`-Select the Publication status from the drop down.
            -Select the templates from the list available.
            -Select the style sheets from the list available.`);
        await KnowledgeReContributionHelper.selectPublicationStatusTemplateAndStyle();
        StepLogger.verification('The options should be selected successfully.');
        await KnowledgeReContributionHelper.verifyPublicationStatusTemplateAndStyle();

        StepLogger.stepId(4);
        StepLogger.step('To select the users click on the Select button in front of the user tile.');
        await KnowledgeReContributionHelper.clickSelectUser();
        StepLogger.verification('Select users dialog box should be opened.');
        await KnowledgeReContributionHelper.verifySelectUserDialog();

        StepLogger.stepId(5);
        StepLogger.step('Click on Show all button.');
        await KnowledgeReContributionHelper.clickShowAllUser();
        StepLogger.verification('All the users should be listed.');
        await KnowledgeReContributionHelper.verifyUserList();

        StepLogger.stepId(6);
        StepLogger.step('Check the checkbox of one or multiple users.');
        await KnowledgeReContributionHelper.selectUser();
        StepLogger.verification('The selected users should be displayed in the Selected users section.');
        await KnowledgeReContributionHelper.verifySelectedUserList();

        StepLogger.stepId(7);
        StepLogger.step('Click on OK button.');
        await KnowledgeReContributionHelper.switchToDialogFrameAndclickOk();
        StepLogger.verification('The selected users should be displayed below the select button.');
        await KnowledgeReContributionHelper.verifySelectedUser();

        StepLogger.stepId(8);
        StepLogger.step('Click on Start.');
        await KnowledgeReContributionHelper.clickStart();
        StepLogger.verification('A confirmation pop should be displayed.');
        await KnowledgeReContributionHelper.verifyPerformTaskPopUpDisplayed();

        StepLogger.stepId(9);
        StepLogger.step('Click on No.');
        await KnowledgeReContributionHelper.clickNoButtonOnPopUp();
        StepLogger.verification('re-contribute Knowledge for Contribute Authored Documents should not be ' +
            'started and Knowledge re-contributor screen should be displayed.'
        );
        await KnowledgeReContributionHelper.verifyPageContent();

        StepLogger.postCondition('Logout');
        await KnowledgeReContributionHelper.switchToFirstTabAndLogOut();
    });

    // Jira References - KNOV-453
    it('To start the re-contribution Knowledge for Contribute Authored Documents. - [22411108]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Feb 2019 08:03:05 GMT
        StepLogger.caseId = 22411108;
        StepLogger.preCondition('Execute test case C22411107 to access Knowledge Re-Contributor screen.');
        await KnowledgeReContributionHelper.navigateToKnowledgeReContribution();

        StepLogger.stepId(1);
        StepLogger.step('Check the "Contribute authored documents" check box.');
        await KnowledgeReContributionHelper.clickContributeAuthoredDocuments();
        StepLogger.verification('The check box should be checked. Generate Bat File and start buttons should get enabled at the bottom of the page.');
        await KnowledgeReContributionHelper.verifyContributeAuthoredDocuments();

        StepLogger.stepId(2);
        StepLogger.step('Provide the id range in the From and To columns.("From" number should always be lower than the "To" number)');
        await KnowledgeReContributionHelper.enterFromAndTwoRange(Constants.stringNumber.one, Constants.stringNumber.two);
        StepLogger.verification('Values should be displayed in the fields.');
        await KnowledgeReContributionHelper.verifyFromAndTwoRange(Constants.stringNumber.one, Constants.stringNumber.two);

        StepLogger.stepId(3);
        StepLogger.step(`-Select the Publication status from the drop down.
            -Select the templates from the list available.
            -Select the style sheets from the list available.`);
        await KnowledgeReContributionHelper.selectPublicationStatusTemplateAndStyle();
        StepLogger.verification('The options should be selected successfully.');
        await KnowledgeReContributionHelper.verifyPublicationStatusTemplateAndStyle();

        StepLogger.stepId(4);
        StepLogger.step('To select the users click on the Select button in front of the user tile.');
        await KnowledgeReContributionHelper.clickSelectUser();
        StepLogger.verification('Select users dialog box should be opened.');
        await KnowledgeReContributionHelper.verifySelectUserDialog();

        StepLogger.stepId(5);
        StepLogger.step('Click on Show all button');
        await KnowledgeReContributionHelper.clickShowAllUser();
        StepLogger.verification('All the users should be listed.');
        await KnowledgeReContributionHelper.verifyUserList();

        StepLogger.stepId(6);
        StepLogger.step('Check the checkbox of one or multiple users.');
        await KnowledgeReContributionHelper.selectUser();
        StepLogger.verification('The selected users should be displayed in the Selected users section.');
        await KnowledgeReContributionHelper.verifySelectedUserList();

        StepLogger.stepId(7);
        StepLogger.step('Click on OK button.');
        await KnowledgeReContributionHelper.switchToDialogFrameAndclickOk();
        StepLogger.verification('The selected users should be displayed below the select button.');
        await KnowledgeReContributionHelper.verifySelectedUser();

        StepLogger.stepId(8);
        StepLogger.step('Click on Start.');
        await KnowledgeReContributionHelper.clickStart();
        StepLogger.verification('A confirmation pop should be displayed.');
        await KnowledgeReContributionHelper.verifyPerformTaskPopUpDisplayed();

        StepLogger.stepId(9);
        StepLogger.step('Click on Yes.');
        await KnowledgeReContributionHelper.clickYesButtonOnPopUp();
        StepLogger.verification(`Contribution Progress Monitor screen should be displayed with 3 tabs available.
            -Contribution
            -Queued tab
            -Previous Runs`);
        await KnowledgeReContributionHelper.verifyContributionProgressMonitorDisplayedAndClickOk();

        StepLogger.postCondition('Logout');
        await KnowledgeReContributionHelper.switchToFirstTabAndLogOut();
    });

    // Jira References - KNOV-453
    it('To verify the View details button. - [22411120]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Feb 2019 08:04:01 GMT
        StepLogger.caseId = 22411120;
        StepLogger.preCondition('Execute test case C22411107 to access Knowledge Re-Contributor screen.');
        await KnowledgeReContributionHelper.navigateToKnowledgeReContribution();

        StepLogger.stepId(1);
        StepLogger.step('Check the "Contribute authored documents" check box.');
        await KnowledgeReContributionHelper.clickContributeAuthoredDocuments();
        StepLogger.verification('The check box should be checked. Generate Bat File and start buttons should get enabled at the bottom of the page.');
        await KnowledgeReContributionHelper.verifyContributeAuthoredDocuments();

        StepLogger.stepId(2);
        StepLogger.step('Provide the id range in the From and To columns.("From" number should always be lower than the "To" number)');
        await KnowledgeReContributionHelper.enterFromAndTwoRange(Constants.stringNumber.one, Constants.stringNumber.two);
        StepLogger.verification('Values should be displayed in the fields.');
        await KnowledgeReContributionHelper.verifyFromAndTwoRange(Constants.stringNumber.one, Constants.stringNumber.two);

        StepLogger.stepId(3);
        StepLogger.step(`-Select the Publication status from the drop down.
            -Select the templates from the list available.
            -Select the style sheets from the list available.`);
        await KnowledgeReContributionHelper.selectPublicationStatusTemplateAndStyle();
        StepLogger.verification('The options should be selected successfully.');
        await KnowledgeReContributionHelper.verifyPublicationStatusTemplateAndStyle();

        StepLogger.stepId(4);
        StepLogger.step('To select the users click on the Select button in front of the user tile.');
        await KnowledgeReContributionHelper.clickSelectUser();
        StepLogger.verification('Select users dialog box should be opened.');
        await KnowledgeReContributionHelper.verifySelectUserDialog();

        StepLogger.stepId(5);
        StepLogger.step('Click on Show all button.');
        await KnowledgeReContributionHelper.clickShowAllUser();
        StepLogger.verification('All the users should be listed.');
        await KnowledgeReContributionHelper.verifyUserList();

        StepLogger.stepId(6);
        StepLogger.step('Check the checkbox of one or multiple users.');
        await KnowledgeReContributionHelper.selectUser();
        StepLogger.verification('The selected users should be displayed in the Selected users section.');
        await KnowledgeReContributionHelper.verifySelectedUserList();

        StepLogger.stepId(7);
        StepLogger.step('Click on OK button.');
        await KnowledgeReContributionHelper.switchToDialogFrameAndclickOk();
        StepLogger.verification('The selected users should be displayed below the select button.');
        await KnowledgeReContributionHelper.verifySelectedUser();

        StepLogger.stepId(8);
        StepLogger.step('Click on Start.');
        await KnowledgeReContributionHelper.clickStart();
        StepLogger.verification('A confirmation pop should be displayed.');
        await KnowledgeReContributionHelper.verifyPerformTaskPopUpDisplayed();

        StepLogger.stepId(9);
        StepLogger.step('Click on Yes.');
        await KnowledgeReContributionHelper.clickYesButtonOnPopUp();
        StepLogger.verification(`Contribution Progress Monitor screen should be displayed with 3 tabs available.
        -Contribution
        -Queued tab
        -Previous Runs`);
        await KnowledgeReContributionHelper.verifyContributionProgressMonitorDisplayed();

        StepLogger.stepId(10);
        StepLogger.step('Click on OK.');
        await KnowledgeReContributionHelper.clickOk();
        StepLogger.verification('Knowledge re-contributor page should be displayed.');
        await KnowledgeReContributionHelper.verifyPageContent();

        StepLogger.stepId(11);
        StepLogger.step('Click on View Details button at the bottom.');
        await KnowledgeReContributionHelper.clickViewDetails();
        StepLogger.verification(`Contribution Progress Monitor screen should be displayed with the following details.
            -Updated
            -Status
            -Total To be processed
            -Items processed
            -Successful
            -Failed
            -Contribution item list containing id, name and status
            -Stop button
            -OK button`);
        await KnowledgeReContributionHelper.verifyViewDetailAndClickOk();

        StepLogger.postCondition('Logout');
        await KnowledgeReContributionHelper.switchToFirstTabAndLogOut();
    });

    // Jira References - KNOV-453
    it('To verify stop button on Knowledge re-contributor page. - [22411121]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Feb 2019 08:04:01 GMT
        StepLogger.caseId = 22411121;
        StepLogger.preCondition('Execute test case C22411108 to start the re-contribution Knowledge for Contribute Authored Documents.');
        await KnowledgeReContributionHelper.navigateToContributionProgressMonitorDisplayedAndClickOk();

        StepLogger.stepId(1);
        StepLogger.step('Click on OK.');
        await KnowledgeReContributionHelper.clickOk();
        StepLogger.verification('Knowledge re-contributor screen should be displayed.');
        await KnowledgeReContributionHelper.verifyPageContent();

        StepLogger.stepId(2);
        StepLogger.step('Click on Stop button at the bottom of the screen.');
        await KnowledgeReContributionHelper.clickViewDetailAndStop();
        StepLogger.verification('Confirmation pop up should be displayed.');
        await KnowledgeReContributionHelper.verifyStopDocumentPopUpDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on Yes.');
        await KnowledgeReContributionHelper.clickYesButtonOnPopUp();
        StepLogger.verification('The running process should be stopped and Knowledge re-contributor page should be displayed.');
        await KnowledgeReContributionHelper.verifyProcessStatusAndPage();

        StepLogger.postCondition('Logout');
        await KnowledgeReContributionHelper.switchToFirstTabAndLogOut();
    });

    // Jira References - KNOV-453
    it('To verify No button on confirmation pop up window when a process is being stopped. - [22411122]', async () => {
        // Auto generated by aurea-automation - util on Mon, 25 Feb 2019 08:04:01 GMT
        StepLogger.caseId = 22411122;
        StepLogger.preCondition('Execute test case C22411108 to start the re-contribution Knowledge for Contribute Authored Documents.');
        await KnowledgeReContributionHelper.navigateToContributionProgressMonitorDisplayedAndClickOk();

        StepLogger.stepId(1);
        StepLogger.step('Click on OK.');
        await KnowledgeReContributionHelper.clickOk();
        StepLogger.verification('Knowledge re-contributor page should be displayed.');
        await KnowledgeReContributionHelper.verifyPageContent();

        StepLogger.stepId(2);
        StepLogger.step('Click on Stop button at the bottom of the screen.');
        await KnowledgeReContributionHelper.clickViewDetailAndStop();
        StepLogger.verification('Confirmation pop up should be displayed.');
        await KnowledgeReContributionHelper.verifyStopDocumentPopUpDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on No.');
        await KnowledgeReContributionHelper.clickNoButtonOnPopUp();
        StepLogger.verification('The running process should not be stopped and Knowledge re-contributor page should be displayed.');
        await KnowledgeReContributionHelper.verifyProcessStatusAndPage();

        StepLogger.postCondition('Logout');
        await KnowledgeReContributionHelper.switchToFirstTabAndLogOut();
    });
});
