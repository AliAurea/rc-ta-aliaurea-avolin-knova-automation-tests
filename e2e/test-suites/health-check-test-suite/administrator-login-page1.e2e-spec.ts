import { browser } from 'protractor';

import { StepLogger } from '../../../core/logger/step-logger';
import { PageHelper } from '../../components/html/page-helper';
import { CredentialsHelper } from '../../components/misc-utils/credentials-helper';
import { AdminHomePageHelper } from '../../page-objects/pages/admin-home-page/admin-home.helper';
import { AdminHomePage } from '../../page-objects/pages/admin-home-page/admin-home.po';
import { AdminLoginPageHelper } from '../../page-objects/pages/admin-login-page/admin-login.helper';
import { SuiteNames } from '../helpers/suite-names';

describe(SuiteNames.healthCheckSuite, () => {
    let loginPageHelper: AdminLoginPageHelper;
    const user = CredentialsHelper.admin;

    beforeAll(async () => {
        loginPageHelper = AdminLoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
        await loginPageHelper.goTo();
    });

    beforeEach(async () => {
        await PageHelper.switchToFirstTab();
        await loginPageHelper.goTo();
        await AdminLoginPageHelper.logout();
    });

    // Jira References - KNOV-90
    it('Logout of Knova Administrator portal - [22308109]', async () => {
        // Auto generated by aurea-automation - util on Wed, 20 Feb 2019 15:06:43 GMT
        StepLogger.caseId = 22308109;

        StepLogger.preCondition('Login Knova Administration successfully refer C22308069');
        await AdminLoginPageHelper.loginAsAdmin();

        StepLogger.stepId(1);
        StepLogger.step('Verify the Landing page is displayed with the name of the Administrator at the top right corner');
        StepLogger.verification('The Name of the Administrator is displayed at the top right corner');
        await AdminHomePageHelper.verifyUserNameAtTheTopRightCorner(CredentialsHelper.admin.username);

        StepLogger.stepId(2);
        await AdminHomePage.hamburgerIcon.clickButton();
        StepLogger.verification('The Menu Navigation is opened on the LHS of the page');
        await AdminHomePageHelper.verifySidebarFieldsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click the "Logout" menu item at the bottom of the menu navigation bar on the LHS');
        await AdminHomePage.sidebar.logout.clickButton();
        StepLogger.verification('The user is logout successfully  and the Knova Administrator portal login page is displayed');
        await AdminLoginPageHelper.verifyUserNotLogged();
    });

    // Jira References - KNOV-90
    it('Confirm Admin user cannot login by clicking the back button after logging out of the Knova Administrator Portal - [22308111]', async () => {
        // Auto generated by aurea-automation - util on Wed, 20 Feb 2019 15:13:12 GMT
        StepLogger.caseId = 22308111;

        StepLogger.preCondition('Login Knova Administration successfully refer C22308069');
        await AdminLoginPageHelper.loginAsAdmin();

        StepLogger.stepId(1);
        StepLogger.step('Verify the Landing page is displayed with the name of the Administrator at the top right corner');
        StepLogger.verification('The Name of the Administrator is displayed at the top right corner');
        await AdminHomePageHelper.verifyUserNameAtTheTopRightCorner(CredentialsHelper.admin.username);

        StepLogger.stepId(2);
        StepLogger.step('Click on Burger button in top LHS');
        await AdminHomePage.hamburgerIcon.clickButton();
        StepLogger.verification('The Menu Navigation is opened on the LHS of the page');
        await AdminHomePageHelper.verifySidebarFieldsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click the "Logout" menu item on the LHS');
        await AdminHomePage.sidebar.logout.clickButton();
        StepLogger.verification('The user is logged out of the Knova Administrator Portal and the Login page is displayed');
        await AdminLoginPageHelper.verifyUserNotLogged();

        StepLogger.stepId(4);
        StepLogger.step('Click the "Back" navigation button beside the URL input box');
        await browser.navigate().back();
        StepLogger.verification('The login page of the Knova Administrator Portal is displayed');
        await AdminLoginPageHelper.verifyUserNotLogged();
    });

    // Jira References - KNOV-90, KNOV-91
    it('View the "Settings" section of the Menu section LHS of the page - [22308759]', async () => {
        // Auto generated by aurea-automation - util on Wed, 20 Feb 2019 16:08:00 GMT
        StepLogger.caseId = 22308759;

        StepLogger.preCondition('Login Knova Administration successfully refer C22308069');
        await AdminLoginPageHelper.loginAsAdmin();

        StepLogger.stepId(1);
        StepLogger.step('Verify the Landing page is displayed with the name of the Administrator at the top right corner');
        StepLogger.verification('The Name of the Administrator is displayed at the top right corner');
        await AdminHomePageHelper.verifyUserNameAtTheTopRightCorner(user.username);

        StepLogger.stepId(2);
        StepLogger.step('Click on Burger button in top LHS');
        await AdminHomePage.hamburgerIcon.clickButton();
        StepLogger.verification('The Menu Navigation is opened on the LHS of the page');
        await AdminHomePageHelper.verifySidebarFieldsDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click on the "Settings" menu item on the LHS of the page');
        await AdminHomePageHelper.clickSettings();
        StepLogger.verification(`The sub menu of the menu item is displayed for the "Settings" menu with the following sub menu list
        "About"
        "Help"`);
        await AdminHomePageHelper.verifySettingsSubMenu();
    });
});
