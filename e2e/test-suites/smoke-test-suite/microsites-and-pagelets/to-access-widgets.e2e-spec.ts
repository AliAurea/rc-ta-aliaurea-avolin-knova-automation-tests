import { StepLogger } from '../../../../core/logger/step-logger';
import { PageHelper } from '../../../components/html/page-helper';
import { Constants } from '../../../components/misc-utils/constants';
import {
    SelfServiceEditProfilePageHelper
} from '../../../page-objects/pages/self-service-profile-editor/self-service-edit-profile.helper';
import { SelfServiceHomePageConstant } from '../../../page-objects/pages/self-service/self-service-home-page.contant';
import { SelfServiceHomePageHelper } from '../../../page-objects/pages/self-service/self-service-home-page.helper';
import { SelfServiceLoginPageHelper } from '../../../page-objects/pages/self-service/self-service-login.helper';
import { SuiteNames } from '../../helpers/suite-names';

describe(SuiteNames.smokeSuite, () => {
    let loginPageHelper: SelfServiceLoginPageHelper;

    beforeAll(async () => {
        loginPageHelper = SelfServiceLoginPageHelper.getInstance();
        await PageHelper.maximiseBrowser();
        await loginPageHelper.goTo();
    });

    beforeEach(async () => {
        await PageHelper.switchToFirstTab();
        await loginPageHelper.goTo();
        await SelfServiceLoginPageHelper.logout();
        await SelfServiceLoginPageHelper.loginAsAdmin();
    });

    // Jira References - KNOV-2461
    it(`Validation of admin user accessing the "Edit Favorite Items" window for a particular
    section from the "My Favorites" widget - [22948223]`, async () => {
            // Auto generated by aurea-automation - util on Mon, 29 Apr 2019 21:00:08 GMT

            StepLogger.caseId = 22948223;
            StepLogger.stepId(1);
            StepLogger.step('Verify if the edit option (pencil symbol) is available on the right end of each available sections in the "My Favorites" widget.');
            StepLogger.verification(`The edit option (pencil symbol) should be available on the
            right end of each available sections in the "My Favorites" widget.`);
            await SelfServiceHomePageHelper.verifyMyFavoritesWidgetEditIcon();

            StepLogger.stepId(2);
            StepLogger.step('Click the edit option (pencil symbol) available for one of the section in the "My Favorites" widget. (e.g, Saved Communities)');
            await SelfServiceHomePageHelper.clickOnMyFavoritesWidgetEditIcon();
            StepLogger.verification('The "Edit Favorite Items" window of the selected section should be displayed for the user.');
            await SelfServiceHomePageHelper.verifyEditFavoriteItemsWindowDisplayed();

            StepLogger.stepId(3);
            StepLogger.step(`Verify if the document names displayed in the "Edit Favorite Items"
            window are in consistent with the ones available in the same section of the "My favorites" widget.`);
            StepLogger.verification(`The document name displayed in the "Edit Favorite Items"
            window should be in consistent with the ones available in the same section of the "My favorites" widget.`);
            await SelfServiceHomePageHelper.verifyEditFavoriteItemsList();

            StepLogger.stepId(4);
            StepLogger.step('Click the "Close" button.');
            await SelfServiceHomePageHelper.clickOnCloseButtonFromPopup();
            StepLogger.verification('The "Edit Favorite Items" window should be closed and the user should be navigated to the user homepage.');
            await SelfServiceHomePageHelper.verifyWindowClosed(Constants.number.one);

            StepLogger.stepId(5);
            StepLogger.step('Click the "Logout" link available at the top right end of the page.');
            await SelfServiceHomePageHelper.clickOnLogOut();
            StepLogger.verification('User should be logged out and the application login page should be displayed.');
            await SelfServiceLoginPageHelper.verifyLoginPageDisplayed();
        });

    // Jira References - KNOV-2463
    it('Validation of admin user refreshing the "My Favorites" widget in homepage of self service portal - [22948287]', async () => {
        // Auto generated by aurea-automation - util on Mon, 29 Apr 2019 21:00:08 GMT

        StepLogger.caseId = 22948287;
        StepLogger.stepId(1);
        StepLogger.step('Verify if the refresh option is available on top right side of the "My Favorites" widget.');
        StepLogger.verification('The refresh option should be available on top right side of the "My Favorites" widget.');
        await SelfServiceHomePageHelper.verifyMyFavoritesRefreshIconDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Click the "Refresh" option.');
        await SelfServiceHomePageHelper.clickOnMyFavoritesRefreshIcon();
        StepLogger.verification('The "My Favorites" widget should get refreshed and if any new documents get added to the list should be displayed.');
        // This action is not verifiable

        StepLogger.stepId(3);
        StepLogger.step('Click the "Logout" link available at the top right end of the page.');
        await SelfServiceHomePageHelper.clickOnLogOut();
        StepLogger.verification('User should be logged out and the application login page should be displayed.');
        await SelfServiceLoginPageHelper.verifyLoginPageDisplayed();
    });

    // Jira References - KNOV-2467
    it(`Validation of admin user navigating to the "Content Subscription" tab of the user
    profile on clicking the "Edit" button in the "My Subscription"
    widget in the homepage of Self Service portal - [22947902]`, async () => {
            // Auto generated by aurea-automation - util on Mon, 29 Apr 2019 21:00:08 GMT

            StepLogger.caseId = 22947902;
            StepLogger.preCondition('Configure "TD_Microsite" as default Microsite');
            const microsite = SelfServiceHomePageConstant.labels.tdMicrosite;
            await SelfServiceEditProfilePageHelper.configureDefaultMicrositeAndNavigateToMicrositeTab(microsite);

            StepLogger.stepId(1);
            StepLogger.step('Verify if the "Edit" button is available on top right side on the "My Subscription" widget.');
            StepLogger.verification('The "Edit" button should be available on top right side on the "My Subscription" widget.');
            await SelfServiceHomePageHelper.verifyMySubscriptionsEditButtonDisplayed();

            StepLogger.stepId(2);
            StepLogger.step('Click the "Edit" button.');
            await SelfServiceHomePageHelper.clickOnMySubscriptionsEditButton();
            StepLogger.verification(`User should be navigated to the "Content Subscriptions" tab of
            user profile with the options to set the "My Subscriptions" widget.`);
            await SelfServiceEditProfilePageHelper.verifyTabHighlighted(
                SelfServiceHomePageConstant.labels.contentSubscriptions);

            StepLogger.stepId(3);
            StepLogger.step('Click the "TD_Microsite" tab name available on top of the page.');
            await SelfServiceHomePageHelper.clickOnAvailableMicrositeTab();
            StepLogger.verification('User should be navigated to the user homepage.');
            await SelfServiceHomePageHelper.verifyUserNavigatedToAdminHomePage();

            StepLogger.stepId(4);
            StepLogger.step('Click the "Logout" link available at the top right end of the page.');
            await SelfServiceHomePageHelper.clickOnLogOut();
            StepLogger.verification('User should be logged out and the application login page should be displayed.');
            await SelfServiceLoginPageHelper.verifyLoginPageDisplayed();
        });

    // Jira References - KNOV-2453
    it(`Validation of admin user refreshing the "Answer Wizards"
    widget in the homepage of self service portal - [22947920]`, async () => {
            // Auto generated by aurea-automation - util on Mon, 29 Apr 2019 21:00:08 GMT

            StepLogger.caseId = 22947920;
            StepLogger.stepId(1);
            StepLogger.step('Verify if the refresh option is available on top right side on the "Answer Wizards" widget.');
            StepLogger.verification('The refresh option should be available on top right side on the "Answer Wizards" widget.');
            await SelfServiceHomePageHelper.verifyRefreshButtonBesideAnswerWizardsWidget();

            StepLogger.stepId(2);
            StepLogger.step('Click the "Refresh" option.');
            await SelfServiceHomePageHelper.clickOnRefreshButtonBesideAnswerWizardsWidget();
            StepLogger.verification(`The "Answer Wizards" widget should get refreshed and if any newly
        answered document is added it should be displayed in the list available.`);
            // This action is no verifiable

            StepLogger.stepId(3);
            StepLogger.step('Click the "Logout" link available at the top right end of the page.');
            await SelfServiceHomePageHelper.clickOnLogOut();
            StepLogger.verification('User should be logged out and the application login page should be displayed.');
            await SelfServiceLoginPageHelper.verifyLoginPageDisplayed();
        });

    // Jira References - KNOV-2454
    it('Validation of viewing the "What"s Popular" widget in the homepage of Self Service portal - [22948198]', async () => {
        // Auto generated by aurea-automation - util on Mon, 29 Apr 2019 21:00:13 GMT

        StepLogger.caseId = 22948198;
        StepLogger.preCondition('Configure "TD_Microsite" as default Microsite');
        const microsite = SelfServiceHomePageConstant.labels.tdMicrosite;
        await SelfServiceEditProfilePageHelper.configureDefaultMicrositeAndNavigateToMicrositeTab(microsite);

        StepLogger.stepId(1);
        StepLogger.step('Verify if the admin user is in the "TD_Microsite" tab of user homepage as default.');
        StepLogger.verification('The admin user should be in the "TD_Microsite" tab of user homepage as default.');
        await SelfServiceHomePageHelper.verifyAvailableMicrositeTopTab(
            SelfServiceHomePageConstant.labels.tdMicrosite);

        StepLogger.stepId(2);
        StepLogger.step(`Scroll down the page and verify if the "What"s Popular" widget is available in
        the bottom right side of the page just below the "Answer Wizards" widget.`);
        StepLogger.verification(`The "What"s Popular" widget should be available in the bottom right side of the
        page just below the "Answer Wizards" widget.`);
        await SelfServiceHomePageHelper.verifyWhatsPopularWidgetDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Scroll up the page and click the "Logout" link available at the top right end of the page.');
        await SelfServiceHomePageHelper.clickOnLogOut();
        StepLogger.verification('User should be logged out and the application login page should be displayed.');
        await SelfServiceLoginPageHelper.verifyLoginPageDisplayed();
    });

    // Jira References - KNOV-2457
    it('Validation of admin user refreshing the "What"s Popular" widget in the homepage of Self Service portal - [22948210]', async () => {
        // Auto generated by aurea-automation - util on Mon, 29 Apr 2019 21:00:08 GMT

        StepLogger.caseId = 22948210;
        StepLogger.stepId(1);
        StepLogger.step('Verify if the refresh option is available on top right side of the "What"s Popular" widget.');
        StepLogger.verification('The refresh option should be available on top right side of the "What"s Popular" widget.');
        await SelfServiceHomePageHelper.verifyWatsNewRefreshButtonDisplayed();

        StepLogger.stepId(2);
        StepLogger.step('Click the "Refresh" option.');
        await SelfServiceHomePageHelper.clickOnWatsNewRefreshButton();
        StepLogger.verification('The "What"s Popular" widget should get refreshed and if any new documents get added to the list should be displayed.');
        // This action is not verifiable

        StepLogger.stepId(3);
        StepLogger.step('Scroll up the page and click the "Logout" link available at the top right end of the page.');
        await SelfServiceHomePageHelper.clickOnLogOut();
        StepLogger.verification('User should be logged out and the application login page should be displayed.');
        await SelfServiceLoginPageHelper.verifyLoginPageDisplayed();
    });

    // Jira References - KNOV-2450
    it(`Validation of admin user navigating to the respective microsite page from the "My Microsites"
    widget available in the homepage of Self Service portal - [22947916]`, async () => {
            // Auto generated by aurea-automation - util on Mon, 29 Apr 2019 21:00:08 GMT

            StepLogger.caseId = 22947916;
            StepLogger.stepId(1);
            StepLogger.step('Verify if the list of available microsites are displayed in the "My Microsites" widget of the homepage.');
            StepLogger.verification(`The list of available microsites should be displayed in
        the "My Microsites" widget of the homepage with the "TD_Microsite" option selected as default.`);
            await SelfServiceHomePageHelper.verifyMyMicrositesItemsDisplayed();

            StepLogger.stepId(2);
            StepLogger.step('Click on a microsite name available in the "My Microsites" widget. (e.g, Customer Microsite)');
            await SelfServiceHomePageHelper.clickOnAMyMicrositesItem();
            StepLogger.verification(`On page refresh user should be in homepage with the
        selected microsite name displayed in the tab name available on top of the page.`);
            await SelfServiceHomePageHelper.verifyUserNavigatedToAdminHomePage();

            StepLogger.stepId(3);
            StepLogger.step('Click the "Logout" link available at the top right end of the page.');
            await SelfServiceHomePageHelper.clickOnLogOut();
            StepLogger.verification('User should be logged out and the application login page should be displayed.');
            await SelfServiceLoginPageHelper.verifyLoginPageDisplayed();
        });

    // Jira References - KNOV-2451
    it('Validation of viewing the "Answer Wizards" widget in the homepage of Self Service portal - [22947917]', async () => {
        // Auto generated by aurea-automation - util on Mon, 29 Apr 2019 21:00:11 GMT

        StepLogger.caseId = 22947917;
        StepLogger.preCondition('Configure "TD_Microsite" as default Microsite');
        const microsite = SelfServiceHomePageConstant.labels.tdMicrosite;
        await SelfServiceEditProfilePageHelper.configureDefaultMicrositeAndNavigateToMicrositeTab(microsite);

        StepLogger.stepId(1);
        StepLogger.step('Verify if the admin user is in the "TD_Microsite" tab of user homepage as default.');
        StepLogger.verification('The admin user should be in the "TD_Microsite" tab of user homepage as default.');
        await SelfServiceHomePageHelper.verifyAvailableMicrositeTopTab(
            SelfServiceHomePageConstant.labels.tdMicrosite);

        StepLogger.stepId(2);
        StepLogger.step(`Scroll to the right end of the page and verify if the
        "Answer Wizards" widget is available in the right side of the page just below the "My Microsites" widget.`);
        StepLogger.verification('The "Answer Wizards" widget should be available in the right side of the page just below the "My Microsites" widget.');
        await SelfServiceHomePageHelper.verifyAnswerWizardsWidgetDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Click the "Logout" link available at the top right end of the page.');
        await SelfServiceHomePageHelper.clickOnLogOut();
        StepLogger.verification('User should be logged out and the application login page should be displayed.');
        await SelfServiceLoginPageHelper.verifyLoginPageDisplayed();
    });

    // Jira References - KNOV-2441
    it('Validation of viewing the "My Subscriptions" widget in the homepage of Self Service portal - [22947899]', async () => {
        // Auto generated by aurea-automation - util on Mon, 29 Apr 2019 21:00:15 GMT

        StepLogger.caseId = 22947899;
        StepLogger.preCondition('Configure "TD_Microsite" as default Microsite');
        const microsite = SelfServiceHomePageConstant.labels.tdMicrosite;
        await SelfServiceEditProfilePageHelper.configureDefaultMicrositeAndNavigateToMicrositeTab(microsite);

        StepLogger.stepId(1);
        StepLogger.step('Verify if the admin user is in the "TD_Microsite" tab of user homepage as default.');
        StepLogger.verification('The admin user should be in the "TD_Microsite" tab of user homepage as default.');
        await SelfServiceHomePageHelper.verifyAvailableMicrositeTopTab(
            SelfServiceHomePageConstant.labels.tdMicrosite);

        StepLogger.stepId(2);
        StepLogger.step(`Scroll down the page and verify if the "My Subscriptions" widget
        is available at the bottom of the page just below the "My favorites" widget.`);
        StepLogger.verification('The "My Subscriptions" widget should be available at the bottom of the page just below the "My favorites" widget.');
        await SelfServiceHomePageHelper.verifyMySubscriptionsWidgetDisplayed();

        StepLogger.stepId(3);
        StepLogger.step('Scroll up the page and click the "Logout" link available at the top right end of the page.');
        await SelfServiceHomePageHelper.clickOnLogOut();
        StepLogger.verification('User should be logged out and the application login page should be displayed.');
        await SelfServiceLoginPageHelper.verifyLoginPageDisplayed();
    });
});
